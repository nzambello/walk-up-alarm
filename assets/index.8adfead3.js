import{r as s,o as L,u as O,a as $,e as j,d as B,f as k,j as l,H as q,b as e,F as V,T as R,i as P,p as _,c as K,g as z,B as w,D as G,C as J,R as Q,h as U}from"./vendor.99e69d04.js";const X=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))f(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&f(h)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function f(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}};X();var Y="/walk-up-alarm/assets/alarm.da63983a.mp3",Z="/walk-up-alarm/assets/blank.495b5f16.mp3",ee="/walk-up-alarm/assets/logo.07634838.svg";function te(){var E;const[o,u]=s.exports.useState(null),[n,f]=s.exports.useState(!1),[t,r]=s.exports.useState(!1),[h,S]=s.exports.useState(!1),[g,F]=s.exports.useState(10),y=s.exports.useRef(null);s.exports.useEffect(()=>{L({"--dark-bg":"#3E3D42","--dark-bg-dark-shadow":"#323135","--dark-bg-light-shadow":"#4a494f","--primary":"#2979ff","--primary-dark":"#2962ff","--primary-light":"#82b1ff"})},[]);const v=O(),{latitude:i,longitude:c,timestamp:ae,accuracy:H}=$.exports.usePosition(!0,{enableHighAccuracy:!0,timeout:1/0,maximumAge:0}),[m,N]=s.exports.useState(null);s.exports.useEffect(()=>{i&&c&&!m&&N({latitude:i,longitude:c})},[i,c,m]);const p=m&&i&&c?j.getDistance(m,{latitude:i,longitude:c},.01):0;s.exports.useEffect(()=>{n&&p>g?A():n&&S(!1)},[p,n]);const A=()=>{var a;S(!0),f(!1),r(!1),u(null),(a=y.current)==null||a.pause(),v.canSleep&&v.allowSleeping()},I=()=>{var a;console.log("ALARM! Wake up!"),r(!0),(a=y.current)==null||a.play(),"Notification"in window?Notification.permission==="granted"?new Notification("Wake up!"):Notification.permission!=="denied"&&Notification.requestPermission().then(function(d){d==="granted"&&new Notification("Wake up!")}):alert("This browser does not support desktop notification")},T=s.exports.useCallback(()=>{var a;o&&((a=y.current)==null||a.play().then(()=>{f(!0),i&&c&&N({latitude:i,longitude:c});const d=B(o,new Date);console.log("set alarm",d),v.canSleep&&v.preventSleeping(),setTimeout(()=>{I()},d)}))},[o]),x=h&&t?"has-walked":t?"alarm-playing":n?"alarm-set":"",[C,D]=s.exports.useState(k(new Date,"HH:mm"));s.exports.useEffect(()=>{const a=setInterval(()=>{!C.includes(":")||t?D(k(new Date,"HH:mm")):D(k(new Date,"HH mm"))},1e3);return()=>clearInterval(a)});const M=a=>{switch(a){case"alarm-playing":return"coral";case"alarm-set":return"#000";case"has-walked":return"teal";default:return"#3E3D42"}},[W,b]=s.exports.useState(!1);return l("div",{className:`App theme--dark ${x}`,children:[l(q,{children:[e("meta",{name:"theme-color",content:M(x)}),e("meta",{name:"msapplication-TileColor",content:M(x)})]}),l("div",{className:"App-header",children:[n&&o?l("p",{children:[e("span",{className:"clock",children:C}),l("small",{children:["Alarm: ",k(o,"HH:mm")]})]}):l(V,{children:[e("img",{src:ee,alt:"",role:"presentation",height:100}),e("h1",{children:"Walk-up alarm"}),l("div",{className:"input-wrapper",children:[e("label",{htmlFor:"alarm-time",children:"Set time for the alarm"}),e(R,{dark:!0,rounded:!0,id:"alarm-time",className:"time-picker",placeholder:"08:00",value:o?k(o,"HH:mm"):void 0,onChange:({value:a})=>{if(P(a,"HH:mm")||P(a,"H:mm")){const d=_(a,"HH:mm",new Date);K(d)?u(z(d,{days:1})):u(d)}}})]}),l("div",{className:"input-wrapper",children:[e("label",{htmlFor:"stop-distance",children:"Stop alarm after (meters):"}),e(R,{dark:!0,rounded:!0,className:"stop-distance",type:"number",id:"stop-distance",placeholder:"distance",value:(E=g==null?void 0:g.toString())!=null?E:"1",onChange:a=>F(parseInt(a.target.value,10))})]})]}),l("div",{children:[!n&&e(w,{dark:!0,rounded:!0,onClick:T,disabled:!o,children:"Set alarm"}),n&&e(w,{dark:!0,text:!0,onClick:()=>b(!0),children:"Reset"}),e(G,{dark:!0,minWidth:300,visible:W,onClose:()=>b(!1),children:l(J,{className:"pa-4 ma-4",children:["Are you sure? ",e("br",{})," ",e("br",{}),e(w,{dark:!0,color:"var(--primary)",rounded:!0,onClick:()=>b(!1),children:"close"}),e(w,{dark:!0,rounded:!0,onClick:()=>{A(),b(!1)},className:"ml-2",children:"reset"})]})}),t&&p&&l("p",{className:"distance",children:["Distance: ",p.toFixed(2)," / ",g," meters"]})]}),e("audio",{src:n?Y:Z,ref:y}),m&&l("code",{children:["original: ",m.latitude,", ",m.longitude,e("br",{}),"current: ",i,", ",c,e("br",{}),"accuracy: ",H&&`${H} meters`,e("br",{}),"distance: ",p&&`${p} meters`]})]})]})}Q.render(e(U.StrictMode,{children:e(te,{})}),document.getElementById("root"));
